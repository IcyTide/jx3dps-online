"use strict";(self.webpackChunkjx3dps_online=self.webpackChunkjx3dps_online||[]).push([[7646],{12892:function(t,e,a){var i=a(29388),r=a(24625),n=a(84803),o=(a(69577),function(t){function e(e){var a=t.call(this,e)||this;a.type="area",a.shapeType="area",a.generatePoints=!0,a.startOnZero=!0;var i=e.startOnZero,r=void 0===i||i,n=e.sortable,o=void 0!==n&&n,s=e.showSinglePoint,h=void 0!==s&&s;return a.startOnZero=r,a.sortable=o,a.showSinglePoint=h,a}return(0,i.ZT)(e,t),e.prototype.getPointsAndData=function(t){for(var e=[],a=[],i=0,n=t.length;i<n;i++){var o=t[i];e.push(o.points),a.push(o[r.wv])}return{points:e,data:a}},e.prototype.getYMinValue=function(){return this.startOnZero?t.prototype.getYMinValue.call(this):this.getYScale().min},e}(n.Z));e.Z=o},10295:function(t,e,a){var i=a(29388),r=a(46053),n=(a(89962),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="edge",e.shapeType="edge",e.generatePoints=!0,e}return(0,i.ZT)(e,t),e}(r.Z));e.Z=n},20017:function(t,e,a){var i=a(29388),r=a(54818),n=a(85595),o=a(51698),s=a(18347),h=a(83579),p=a(24625),l=a(47557),c=function(t){function e(e){var a=t.call(this,e)||this;a.labelShape=[],a.states=[];var i=e.shapeFactory,r=e.container,n=e.offscreenGroup,o=e.elementIndex,s=e.visible,h=void 0===s||s;return a.shapeFactory=i,a.container=r,a.offscreenGroup=n,a.visible=h,a.elementIndex=o,a}return(0,i.ZT)(e,t),e.prototype.draw=function(t,e){void 0===e&&(e=!1),this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.drawShape(t,e),!1===this.visible&&this.changeVisible(!1)},e.prototype.update=function(t){var e=this.shapeFactory,a=this.shape;if(a){this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.setShapeInfo(a,t);var i=this.getOffscreenGroup(),r=e.drawShape(this.shapeType,t,i);r.cfg.data=this.data,r.cfg.origin=t,r.cfg.element=this,this.syncShapeStyle(a,r,this.getStates(),this.getAnimateCfg("update"))}},e.prototype.destroy=function(){var e=this.shapeFactory,a=this.shape;if(a){var r=this.getAnimateCfg("leave");r?(0,o.IZ)(a,r,{coordinate:e.coordinate,toAttrs:(0,i.pi)({},a.attr())}):a.remove(!0)}this.states=[],this.shapeFactory=void 0,this.container=void 0,this.shape=void 0,this.animate=void 0,this.geometry=void 0,this.labelShape=[],this.model=void 0,this.data=void 0,this.offscreenGroup=void 0,this.statesStyle=void 0,t.prototype.destroy.call(this)},e.prototype.changeVisible=function(e){t.prototype.changeVisible.call(this,e),e?(this.shape&&this.shape.show(),this.labelShape&&this.labelShape.forEach((function(t){t.show()}))):(this.shape&&this.shape.hide(),this.labelShape&&this.labelShape.forEach((function(t){t.hide()})))},e.prototype.setState=function(t,e){var a=this,i=a.states,r=a.shapeFactory,o=a.model,s=a.shape,h=a.shapeType,p=i.indexOf(t);if(e){if(p>-1)return;i.push(t),"active"!==t&&"selected"!==t||null===s||void 0===s||s.toFront()}else{if(-1===p)return;if(i.splice(p,1),"active"===t||"selected"===t){var l=this.geometry,c=l.sortZIndex,u=l.zIndexReversed?this.geometry.elements.length-this.elementIndex:this.elementIndex;c?s.setZIndex(u):s.set("zIndex",u)}}var f=r.drawShape(h,o,this.getOffscreenGroup());i.length?this.syncShapeStyle(s,f,i,null):this.syncShapeStyle(s,f,["reset"],null),f.remove(!0);var g={state:t,stateStatus:e,element:this,target:this.container};this.container.emit("statechange",g),(0,n.propagationDelegate)(this.shape,"statechange",g)},e.prototype.clearStates=function(){var t=this,e=this.states;(0,r.S6)(e,(function(e){t.setState(e,!1)})),this.states=[]},e.prototype.hasState=function(t){return this.states.includes(t)},e.prototype.getStates=function(){return this.states},e.prototype.getData=function(){return this.data},e.prototype.getModel=function(){return this.model},e.prototype.getBBox=function(){var t=this.shape,e=this.labelShape,a={x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};return t&&(a=t.getCanvasBBox()),e&&e.forEach((function(t){var e=t.getCanvasBBox();a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y),a.minX=Math.min(e.minX,a.minX),a.minY=Math.min(e.minY,a.minY),a.maxX=Math.max(e.maxX,a.maxX),a.maxY=Math.max(e.maxY,a.maxY)})),a.width=a.maxX-a.minX,a.height=a.maxY-a.minY,a},e.prototype.getStatesStyle=function(){if(!this.statesStyle){var t=this,e=t.shapeType,a=t.geometry,i=t.shapeFactory,n=a.stateOption,o=i.defaultShapeType,s=i.theme[e]||i.theme[o];this.statesStyle=(0,r.b$)({},s,n)}return this.statesStyle},e.prototype.getStateStyle=function(t,e){var a=this.getStatesStyle(),i=(0,r.U2)(a,[t,"style"],{}),n=i[e]||i;return(0,r.mf)(n)?n(this):n},e.prototype.getAnimateCfg=function(t){var e=this,a=this.animate;if(a){var n=a[t];return n?(0,i.pi)((0,i.pi)({},n),{callback:function(){var t;(0,r.mf)(n.callback)&&n.callback(),null===(t=e.geometry)||void 0===t||t.emit(p.oz.AFTER_DRAW_ANIMATE)}}):n}return null},e.prototype.drawShape=function(t,e){var a;void 0===e&&(e=!1);var n=this,s=n.shapeFactory,h=n.container,l=n.shapeType;if(this.shape=s.drawShape(l,t,h),this.shape){this.setShapeInfo(this.shape,t);var c=this.shape.cfg.name;c?(0,r.HD)(c)&&(this.shape.cfg.name=["element",c]):this.shape.cfg.name=["element",this.shapeFactory.geometryType];var u=e?"enter":"appear",f=this.getAnimateCfg(u);f&&(null===(a=this.geometry)||void 0===a||a.emit(p.oz.BEFORE_DRAW_ANIMATE),(0,o.IZ)(this.shape,f,{coordinate:s.coordinate,toAttrs:(0,i.pi)({},this.shape.attr())}))}},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.setShapeInfo=function(t,e){var a=this;(t.cfg.origin=e,t.cfg.element=this,t.isGroup())&&t.get("children").forEach((function(t){a.setShapeInfo(t,e)}))},e.prototype.syncShapeStyle=function(t,e,a,i,n){var s,c=this;if(void 0===a&&(a=[]),void 0===n&&(n=0),t&&e){var u=t.get("clipShape"),f=e.get("clipShape");if(this.syncShapeStyle(u,f,a,i),t.isGroup())for(var g=t.get("children"),d=e.get("children"),y=0;y<g.length;y++)this.syncShapeStyle(g[y],d[y],a,i,n+y);else{if(!(0,r.xb)(a)&&!(0,r.Xy)(a,["reset"])){var v=t.get("name");(0,r.kJ)(v)&&(v=v[1]),(0,r.S6)(a,(function(t){if(e.get("name")!==l.r){var a=c.getStateStyle(t,v||n);e.attr(a)}}))}var m=(0,h.L$)(t,e);this.animate?i?(null===(s=this.geometry)||void 0===s||s.emit(p.oz.BEFORE_DRAW_ANIMATE),(0,o.IZ)(t,i,{coordinate:this.shapeFactory.coordinate,toAttrs:m,shapeModel:this.model})):(0,r.xb)(a)?t.attr(m):(t.stopAnimate(),t.animate(m,{duration:300})):t.attr(m)}}},e.prototype.getShapeType=function(t){var e=(0,r.U2)(t,"shape");return(0,r.kJ)(e)?e[0]:e},e}(s.Z);e.Z=c},95955:function(t,e,a){var i=a(29388),r=a(10926),n=a(54818),o=a(24625),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="heatmap",e.paletteCache={},e}return(0,i.ZT)(e,t),e.prototype.updateElements=function(t,e){void 0===e&&(e=!1);for(var a=0;a<t.length;a++){var i=t[a],r=this.prepareRange(i),o=this.prepareSize(),s=(0,n.U2)(this.styleOption,["cfg","shadowBlur"]);(0,n.hj)(s)||(s=o/2),this.prepareGreyScaleBlurredCircle(o,s),this.drawWithRange(i,r,o,s)}},e.prototype.color=function(t,e){return this.createAttrOption("color",t,"function"!==typeof e?e:""),this},e.prototype.clear=function(){t.prototype.clear.call(this),this.clearShadowCanvasCtx(),this.paletteCache={}},e.prototype.prepareRange=function(t){var e=this.getAttribute("color").getFields()[0],a=1/0,i=-1/0;return t.forEach((function(t){var r=t[o.wv][e];r>i&&(i=r),r<a&&(a=r)})),a===i&&(a=i-1),[a,i]},e.prototype.prepareSize=function(){var t=this.getDefaultValue("size");return(0,n.hj)(t)||(t=this.getDefaultSize()),t},e.prototype.prepareGreyScaleBlurredCircle=function(t,e){var a=this.getGrayScaleBlurredCanvas(),i=t+e,r=a.getContext("2d");a.width=a.height=2*i,r.clearRect(0,0,a.width,a.height),r.shadowOffsetX=r.shadowOffsetY=2*i,r.shadowBlur=e,r.shadowColor="black",r.beginPath(),r.arc(-i,-i,t,0,2*Math.PI,!0),r.closePath(),r.fill()},e.prototype.drawWithRange=function(t,e,a,r){var n,s,h=this.coordinate,p=h.start,l=h.end,c=this.coordinate.getWidth(),u=this.coordinate.getHeight(),f=this.getAttribute("color").getFields()[0];this.clearShadowCanvasCtx();var g=this.getShadowCanvasCtx();e&&(t=t.filter((function(t){return t[o.wv][f]<=e[1]&&t[o.wv][f]>=e[0]})));var d=this.scales[f];try{for(var y=(0,i.XA)(t),v=y.next();!v.done;v=y.next()){var m=v.value,S=this.getDrawCfg(m),b=S.x,x=S.y,C=d.scale(m[o.wv][f]);this.drawGrayScaleBlurredCircle(b-p.x,x-l.y,a+r,C,g)}}catch(A){n={error:A}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(n)throw n.error}}var w=g.getImageData(0,0,c,u);this.clearShadowCanvasCtx(),this.colorize(w),g.putImageData(w,0,0);var I=this.getImageShape();I.attr("x",p.x),I.attr("y",l.y),I.attr("width",c),I.attr("height",u),I.attr("img",g.canvas),I.set("origin",this.getShapeInfo(t))},e.prototype.getDefaultSize=function(){var t=this.getAttribute("position"),e=this.coordinate;return Math.min(e.getWidth()/(4*t.scales[0].ticks.length),e.getHeight()/(4*t.scales[1].ticks.length))},e.prototype.clearShadowCanvasCtx=function(){var t=this.getShadowCanvasCtx();t.clearRect(0,0,t.canvas.width,t.canvas.height)},e.prototype.getShadowCanvasCtx=function(){var t=this.shadowCanvas;return t||(t=document.createElement("canvas"),this.shadowCanvas=t),t.width=this.coordinate.getWidth(),t.height=this.coordinate.getHeight(),t.getContext("2d")},e.prototype.getGrayScaleBlurredCanvas=function(){return this.grayScaleBlurredCanvas||(this.grayScaleBlurredCanvas=document.createElement("canvas")),this.grayScaleBlurredCanvas},e.prototype.drawGrayScaleBlurredCircle=function(t,e,a,i,r){var n=this.getGrayScaleBlurredCanvas();r.globalAlpha=i,r.drawImage(n,t-a,e-a)},e.prototype.colorize=function(t){for(var e=this.getAttribute("color"),a=t.data,i=this.paletteCache,o=3;o<a.length;o+=4){var s=a[o];if((0,n.hj)(s)){var h=i[s]?i[s]:r.Z.rgb2arr(e.gradient(s/256));a[o-3]=h[0],a[o-2]=h[1],a[o-1]=h[2],a[o]=s}}},e.prototype.getImageShape=function(){var t=this.imageShape;return t||(t=this.container.addShape({type:"image",attrs:{}}),this.imageShape=t,t)},e.prototype.getShapeInfo=function(t){var e=this.getDrawCfg(t[0]),a=t.map((function(t){return t[o.wv]}));return(0,i.pi)((0,i.pi)({},e),{mappingData:t,data:a})},e}(a(46053).Z);e.Z=s},73035:function(t,e,a){var i=a(29388),r=a(54818),n=a(34482),o=a(46053),s=(a(55547),a(21414)),h=a(30090),p=function(t){function e(e){var a=t.call(this,e)||this;a.type="interval",a.shapeType="interval",a.generatePoints=!0;var i=e.background;return a.background=i,a}return(0,i.ZT)(e,t),e.prototype.createShapePointsCfg=function(e){var a,i=t.prototype.createShapePointsCfg.call(this,e),r=this.getAttribute("size");if(r){a=this.getAttributeValues(r,e)[0];var o=this.coordinate;a/=(0,n.YO)(o)}else this.defaultSize||(this.defaultSize=(0,s.C)(this)),a=this.defaultSize;return i.size=a,i},e.prototype.adjustScale=function(){t.prototype.adjustScale.call(this);var e=this.getYScale();if("theta"===this.coordinate.type)e.change({nice:!1,min:0,max:(0,h.OI)(e)});else{var a=this.scaleDefs,i=e.field,n=e.min,o=e.max;"time"!==e.type&&(n>0&&!(0,r.U2)(a,[i,"min"])&&e.change({min:0}),o<=0&&!(0,r.U2)(a,[i,"max"])&&e.change({max:0}))}},e.prototype.getDrawCfg=function(e){var a=t.prototype.getDrawCfg.call(this,e);return a.background=this.background,a},e}(o.Z);e.Z=p},35760:function(t,e,a){var i=a(29388),r=a(54818),n=a(24625),o=a(51698),s=a(83579),h=a(20227);function p(t){var e=0;return(0,r.S6)(t,(function(t){e+=t})),e/t.length}var l=function(){function t(t){this.geometry=t}return t.prototype.getLabelItems=function(t){var e=this,a=[],n=this.getLabelCfgs(t);return(0,r.S6)(t,(function(t,o){var s=n[o];if(!s||(0,r.UM)(t.x)||(0,r.UM)(t.y))a.push(null);else{var h=(0,r.kJ)(s.content)?s.content:[s.content];s.content=h;var p=h.length;(0,r.S6)(h,(function(n,o){if((0,r.UM)(n)||""===n)a.push(null);else{var h=(0,i.pi)((0,i.pi)({},s),e.getLabelPoint(s,t,o));h.textAlign||(h.textAlign=e.getLabelAlign(h,o,p)),h.offset<=0&&(h.labelLine=null),a.push(h)}}))}})),a},t.prototype.render=function(t,e){return void 0===e&&(e=!1),(0,i.mG)(this,void 0,void 0,(function(){var a,r,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return a=this.getLabelItems(t),r=this.getLabelsRenderer(),n=this.getGeometryShapes(),[4,r.render(a,n,e)];case 1:return i.sent(),[2]}}))}))},t.prototype.clear=function(){var t=this.labelsRenderer;t&&t.clear()},t.prototype.destroy=function(){var t=this.labelsRenderer;t&&t.destroy(),this.labelsRenderer=null},t.prototype.getCoordinate=function(){return this.geometry.coordinate},t.prototype.getDefaultLabelCfg=function(t,e){var a=this.geometry,i=a.type,n=a.theme;return"polygon"===i||"interval"===i&&"middle"===e||t<0&&!["line","point","path"].includes(i)?(0,r.U2)(n,"innerLabels",{}):(0,r.U2)(n,"labels",{})},t.prototype.getThemedLabelCfg=function(t){var e=this.geometry,a=this.getDefaultLabelCfg(),i=e.type,n=e.theme;return"polygon"===i||t.offset<0&&!["line","point","path"].includes(i)?(0,r.b$)({},a,n.innerLabels,t):(0,r.b$)({},a,n.labels,t)},t.prototype.setLabelPosition=function(t,e,a,i){},t.prototype.getLabelOffset=function(t){var e=this.getCoordinate(),a=this.getOffsetVector(t);return e.isTransposed?a[0]:a[1]},t.prototype.getLabelOffsetPoint=function(t,e,a){var i=t.offset,r=this.getCoordinate().isTransposed,n=r?"x":"y",o=r?1:-1,s={x:0,y:0};return s[n]=e>0||1===a?i*o:i*o*-1,s},t.prototype.getLabelPoint=function(t,e,a){var i=this.getCoordinate(),n=t.content.length;function o(e,a,i){void 0===i&&(i=!1);var n=e;return(0,r.kJ)(n)&&(n=1===t.content.length?i?p(n):n.length<=2?n[e.length-1]:p(n):n[a]),n}var h={content:t.content[a],x:0,y:0,start:{x:0,y:0},color:"#fff"},l=(0,r.kJ)(e.shape)?e.shape[0]:e.shape,c="funnel"===l||"pyramid"===l;if("polygon"===this.geometry.type){var u=(0,s.p9)(e.x,e.y);h.x=u[0],h.y=u[1]}else"interval"!==this.geometry.type||c?(h.x=o(e.x,a),h.y=o(e.y,a)):(h.x=o(e.x,a,!0),h.y=o(e.y,a));if(c){var f=(0,r.U2)(e,"nextPoints"),g=(0,r.U2)(e,"points");if(f){var d=i.convert(g[1]),y=i.convert(f[1]);h.x=(d.x+y.x)/2,h.y=(d.y+y.y)/2}else if("pyramid"===l){d=i.convert(g[1]),y=i.convert(g[2]);h.x=(d.x+y.x)/2,h.y=(d.y+y.y)/2}}t.position&&this.setLabelPosition(h,e,a,t.position);var v=this.getLabelOffsetPoint(t,a,n);return h.start={x:h.x,y:h.y},h.x+=v.x,h.y+=v.y,h.color=e.color,h},t.prototype.getLabelAlign=function(t,e,a){var i="center";if(this.getCoordinate().isTransposed){var r=t.offset;i=r<0?"right":0===r?"center":"left",a>1&&0===e&&("right"===i?i="left":"left"===i&&(i="right"))}return i},t.prototype.getLabelId=function(t){var e=this.geometry,a=e.type,i=e.getXScale(),r=e.getYScale(),o=t[n.wv],s=e.getElementId(t);return"line"===a||"area"===a?s+=" ".concat(o[i.field]):"path"===a&&(s+=" ".concat(o[i.field],"-").concat(o[r.field])),s},t.prototype.getLabelsRenderer=function(){var t=this.geometry,e=t.labelsContainer,a=t.labelOption,i=t.canvasRegion,n=t.animateOption,s=this.geometry.coordinate,p=this.labelsRenderer;return p||(p=new h.Z({container:e,layout:(0,r.U2)(a,["cfg","layout"],{type:this.defaultLayout})}),this.labelsRenderer=p),p.region=i,p.animate=!!n&&(0,o.cd)("label",s),p},t.prototype.getLabelCfgs=function(t){var e=this,a=this.geometry,o=a.labelOption,s=a.scales,h=a.coordinate,p=o,l=p.fields,c=p.callback,u=p.cfg,f=l.map((function(t){return s[t]})),g=[];return(0,r.S6)(t,(function(t,a){var o,s=t[n.wv],p=e.getLabelText(s,f);if(c){var d=l.map((function(t){return s[t]}));if(o=c.apply(void 0,(0,i.ev)([],(0,i.CR)(d),!1)),(0,r.UM)(o))return void g.push(null)}var y=(0,i.pi)((0,i.pi)({id:e.getLabelId(t),elementId:e.geometry.getElementId(t),data:s,mappingData:t,coordinate:h},u),o);(0,r.mf)(y.position)&&(y.position=y.position(s,t,a));var v=e.getLabelOffset(y.offset||0),m=e.getDefaultLabelCfg(v,y.position);(y=(0,r.b$)({},m,y)).offset=e.getLabelOffset(y.offset||0);var S=y.content;(0,r.mf)(S)?y.content=S(s,t,a):(0,r.o8)(S)&&(y.content=p[0]),g.push(y)})),g},t.prototype.getLabelText=function(t,e){var a=[];return(0,r.S6)(e,(function(e){var i=t[e.field];i=(0,r.kJ)(i)?i.map((function(t){return e.getText(t)})):e.getText(i),(0,r.UM)(i)||""===i?a.push(null):a.push(i)})),a},t.prototype.getOffsetVector=function(t){void 0===t&&(t=0);var e=this.getCoordinate(),a=0;return(0,r.hj)(t)&&(a=t),e.isTransposed?e.applyMatrix(a,0):e.applyMatrix(0,a)},t.prototype.getGeometryShapes=function(){var t=this.geometry,e={};return(0,r.S6)(t.elementsMap,(function(t,a){e[a]=t.shape})),(0,r.S6)(t.getOffscreenGroup().getChildren(),(function(a){var i=t.getElementId(a.get("origin").mappingData);e[i]=a})),e},t}();e.Z=l}}]);
//# sourceMappingURL=7646.d74de60e.js.map